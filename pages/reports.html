<div class="surface section">
  <h2>Reports</h2>
  <p class="muted">
    Switch the view. In <strong>Engineer time</strong> expand rows and click
    <em>Open</em>/<em>Closed</em>/<em>Logs</em> to view items. In <strong>Project time</strong> use search & analytics.
  </p>

  <!-- Segmented control -->
  <div class="row" style="gap:8px; margin:10px 0 18px">
    <button class="btn green" data-report="engineers">Engineer time</button>
    <button class="btn" data-report="projects">Project time</button>
  </div>

  <!-- ================= ENGINEER VIEW ================= -->
  <div id="rpt-engineers">
    <!-- Header stats + CSV export buttons -->
    <div class="surface section" style="margin-bottom:14px">
      <div class="spaced" style="align-items:flex-end">
        <div>
          <strong>Totals</strong>
          <div class="row" style="gap:18px; margin-top:10px; align-items:flex-end">
            <div>
              <div class="muted" style="font-size:12px">Total logged hours</div>
              <div style="font-size:24px; font-weight:700">340 h</div>
            </div>
            <div style="flex:1">
              <div class="muted" style="font-size:12px; margin-bottom:6px">Hours by engineer</div>
              <div class="mini-bars">
                <div class="row" style="gap:8px"><span class="muted" style="width:90px">Elvijs</span><div class="bar" style="flex:1"><div class="fill" style="width:55%"></div></div><span class="muted">188h</span></div>
                <div class="row" style="gap:8px"><span class="muted" style="width:90px">Juris</span><div class="bar" style="flex:1"><div class="fill" style="width:45%"></div></div><span class="muted">152h</span></div>
              </div>
            </div>
          </div>
        </div>
        <div class="row" style="gap:8px">
          <button class="btn" id="exportEngSummary">Export summary CSV</button>
          <button class="btn" id="exportEngLogs">Export logs CSV</button>
        </div>
      </div>
    </div>

    <!-- Engineers table -->
    <table class="surface" id="engineerTable" style="width:100%">
      <thead>
        <tr>
          <th>User</th>
          <th>Total logged hours</th>
          <th>Projects</th>
          <th>Role</th>
          <th>Contributions</th>
        </tr>
      </thead>
      <tbody>
        <!-- Elvijs -->
        <tr class="expand" data-expand="eng-elvijs" style="cursor:pointer">
          <td>Elvijs</td>
          <td>188</td>
          <td>15</td>
          <td>Lead engineer</td>
          <td>
            <a href="#" data-logs data-engineer="Elvijs">Logs: 42</a> ‚Ä¢
            <a href="#" data-issues data-engineer="Elvijs" data-kind="open">Open: 3</a> ‚Ä¢
            <a href="#" data-issues data-engineer="Elvijs" data-kind="closed">Closed: 9</a>
          </td>
        </tr>
        <tr id="eng-elvijs" class="hide">
          <td colspan="5">
            <div class="surface section" style="padding:14px">
              <strong>Elvijs ‚Äî project breakdown</strong>
              <table style="width:100%; margin-top:8px">
                <thead>
                  <tr>
                    <th>Project</th><th>Hours</th><th>Logs</th><th>Open issues</th><th>Closed issues</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>DFS 4√ó4</td><td>52</td>
                    <td><a href="#" data-logs data-engineer="Elvijs" data-project="DFS 4√ó4">10</a></td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="open" data-project="DFS 4√ó4">1</a></td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="closed" data-project="DFS 4√ó4">3</a></td>
                  </tr>
                  <tr>
                    <td>AccuSeamer Rev-B</td><td>44</td>
                    <td><a href="#" data-logs data-engineer="Elvijs" data-project="AccuSeamer Rev-B">9</a></td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="open" data-project="AccuSeamer Rev-B">1</a></td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="closed" data-project="AccuSeamer Rev-B">2</a></td>
                  </tr>
                  <tr>
                    <td>XL-200 Bender</td><td>32</td>
                    <td><a href="#" data-logs data-engineer="Elvijs" data-project="XL-200 Bender">8</a></td>
                    <td>0</td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="closed" data-project="XL-200 Bender">1</a></td>
                  </tr>
                  <tr>
                    <td>DXL-350 Docs</td><td>18</td>
                    <td><a href="#" data-logs data-engineer="Elvijs" data-project="DXL-350 Docs">5</a></td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="open" data-project="DXL-350 Docs">1</a></td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>Alignment Jig</td><td>12</td>
                    <td><a href="#" data-logs data-engineer="Elvijs" data-project="Alignment Jig">3</a></td>
                    <td>0</td>
                    <td><a href="#" data-issues data-engineer="Elvijs" data-kind="closed" data-project="Alignment Jig">1</a></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </td>
        </tr>

        <!-- Juris -->
        <tr class="expand" data-expand="eng-juris" style="cursor:pointer">
          <td>Juris</td>
          <td>152</td>
          <td>12</td>
          <td>Engineer</td>
          <td>
            <a href="#" data-logs data-engineer="Juris">Logs: 35</a> ‚Ä¢
            <a href="#" data-issues data-engineer="Juris" data-kind="open">Open: 2</a> ‚Ä¢
            <a href="#" data-issues data-engineer="Juris" data-kind="closed">Closed: 7</a>
          </td>
        </tr>
        <tr id="eng-juris" class="hide">
          <td colspan="5">
            <div class="surface section" style="padding:14px">
              <strong>Juris ‚Äî project breakdown</strong>
              <table style="width:100%; margin-top:8px">
                <thead>
                  <tr>
                    <th>Project</th><th>Hours</th><th>Logs</th><th>Open issues</th><th>Closed issues</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>DFS 4√ó4</td><td>38</td>
                    <td><a href="#" data-logs data-engineer="Juris" data-project="DFS 4√ó4">7</a></td>
                    <td><a href="#" data-issues data-engineer="Juris" data-kind="open" data-project="DFS 4√ó4">1</a></td>
                    <td><a href="#" data-issues data-engineer="Juris" data-kind="closed" data-project="DFS 4√ó4">1</a></td>
                  </tr>
                  <tr>
                    <td>AccuSeamer Rev-B</td><td>29</td>
                    <td><a href="#" data-logs data-engineer="Juris" data-project="AccuSeamer Rev-B">6</a></td>
                    <td>0</td>
                    <td><a href="#" data-issues data-engineer="Juris" data-kind="closed" data-project="AccuSeamer Rev-B">2</a></td>
                  </tr>
                  <tr>
                    <td>Conveyor Retrofit</td><td>21</td>
                    <td><a href="#" data-logs data-engineer="Juris" data-project="Conveyor Retrofit">5</a></td>
                    <td><a href="#" data-issues data-engineer="Juris" data-kind="open" data-project="Conveyor Retrofit">1</a></td>
                    <td>0</td>
                  </tr>
                  <tr>
                    <td>DXL-350 Docs</td><td>16</td>
                    <td><a href="#" data-logs data-engineer="Juris" data-project="DXL-350 Docs">4</a></td>
                    <td>0</td>
                    <td><a href="#" data-issues data-engineer="Juris" data-kind="closed" data-project="DXL-350 Docs">1</a></td>
                  </tr>
                  <tr>
                    <td>XL-200 Bender</td><td>12</td>
                    <td><a href="#" data-logs data-engineer="Juris" data-project="XL-200 Bender">3</a></td>
                    <td>0</td>
                    <td>0</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ================= PROJECT VIEW (unchanged from previous) ================= -->
  <div id="rpt-projects" class="hide">
    <div class="row" style="gap:10px; flex-wrap:wrap; align-items:center; margin-bottom:10px">
      <span class="stat" id="kpi-hours"><span class="i">üïí</span> <strong>‚Äî</strong> total</span>
      <span class="stat" id="kpi-projects"><span class="i">üì¶</span> <strong>‚Äî</strong> projects</span>
      <span class="stat" id="kpi-avg"><span class="i">‚âÉ</span> <strong>‚Äî</strong> avg/project</span>
      <span class="stat" id="kpi-logs"><span class="i">#</span> Logs <strong>‚Äî</strong></span>
      <span class="stat" id="kpi-open" style="color:var(--red)"><span class="i">‚óè</span> Open <strong>‚Äî</strong></span>
      <span class="stat" id="kpi-closed" style="color:var(--green)"><span class="i">‚úî</span> Closed <strong>‚Äî</strong></span>

      <label class="row" style="gap:6px; margin-left:auto">
        <input type="checkbox" id="hideIdle"> <span class="muted">Hide idle (0h)</span>
      </label>
      <input id="projSearch" class="input" placeholder="Search project by title or ID‚Ä¶" style="width:280px">
      <button class="btn" id="exportCsv">Export CSV</button>
    </div>

    <div class="kanban" style="grid-template-columns:repeat(2,1fr); margin-bottom:12px">
      <div class="card">
        <div class="spaced"><strong>Top 5 by hours</strong></div>
        <table style="width:100%">
          <thead><tr><th style="width:55%">Project</th><th style="text-align:right">Hours</th></tr></thead>
          <tbody id="top5"></tbody>
        </table>
      </div>
      <div class="card">
        <div class="spaced"><strong>Bottom 5 by hours (active &gt; 0h)</strong></div>
        <table style="width:100%">
          <thead><tr><th style="width:55%">Project</th><th style="text-align:right">Hours</th></tr></thead>
          <tbody id="bottom5"></tbody>
        </table>
      </div>
    </div>

    <div class="kanban" id="projectGrid" style="grid-template-columns:repeat(2,1fr)">
      <div class="card project-item"
           data-title="DFS 4x4 dfs 4√ó4 dfs4"
           data-hours="98" data-logs="19" data-open="2" data-closed="5"
           data-hours-by='{"Elvijs":52,"Juris":38,"Anna":8}'>
        <div class="spaced">
          <strong>DFS 4√ó4</strong>
          <span class="stat hours head"><span class="i">üïí</span> 98h total</span>
        </div>
        <div class="muted" style="margin:6px 0 8px">Hours by engineer</div>
        <div class="mini-bars">
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Elvijs</span><div class="bar" style="flex:1"><div class="fill" style="width:53%"></div></div><span class="muted">52h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Juris</span><div class="bar" style="flex:1"><div class="fill" style="width:39%"></div></div><span class="muted">38h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Anna</span><div class="bar" style="flex:1"><div class="fill" style="width:8%"></div></div><span class="muted">8h</span></div>
        </div>
        <div class="stats" style="margin-top:12px">
          <span class="stat"><span class="i">#</span> Logs 19</span>
          <span class="stat" style="color:var(--red)"><span class="i">‚óè</span> Open 2</span>
          <span class="stat" style="color:var(--green)"><span class="i">‚úî</span> Closed 5</span>
        </div>
      </div>

      <div class="card project-item"
           data-title="AccuSeamer Rev-B accuseamer rev b rev-b"
           data-hours="71" data-logs="15" data-open="1" data-closed="4"
           data-hours-by='{"Elvijs":44,"Juris":29,"Igors":10}'>
        <div class="spaced">
          <strong>AccuSeamer Rev-B</strong>
          <span class="stat hours head"><span class="i">üïí</span> 71h total</span>
        </div>
        <div class="muted" style="margin:6px 0 8px">Hours by engineer</div>
        <div class="mini-bars">
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Elvijs</span><div class="bar" style="flex:1"><div class="fill" style="width:62%"></div></div><span class="muted">44h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Juris</span><div class="bar" style="flex:1"><div class="fill" style="width:41%"></div></div><span class="muted">29h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Igors</span><div class="bar" style="flex:1"><div class="fill" style="width:14%"></div></div><span class="muted">10h</span></div>
        </div>
        <div class="stats" style="margin-top:12px">
          <span class="stat"><span class="i">#</span> Logs 15</span>
          <span class="stat" style="color:var(--red)"><span class="i">‚óè</span> Open 1</span>
          <span class="stat" style="color:var(--green)"><span class="i">‚úî</span> Closed 4</span>
        </div>
      </div>

      <div class="card project-item"
           data-title="XL-200 Bender xl200 bender xl-200"
           data-hours="44" data-logs="12" data-open="0" data-closed="3"
           data-hours-by='{"Marta":21,"Juris":12,"Elvijs":9}'>
        <div class="spaced">
          <strong>XL-200 Bender</strong>
          <span class="stat hours head"><span class="i">üïí</span> 44h total</span>
        </div>
        <div class="muted" style="margin:6px 0 8px">Hours by engineer</div>
        <div class="mini-bars">
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Marta</span><div class="bar" style="flex:1"><div class="fill" style="width:48%"></div></div><span class="muted">21h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Juris</span><div class="bar" style="flex:1"><div class="fill" style="width:27%"></div></div><span class="muted">12h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Elvijs</span><div class="bar" style="flex:1"><div class="fill" style="width:20%"></div></div><span class="muted">9h</span></div>
        </div>
        <div class="stats" style="margin-top:12px">
          <span class="stat"><span class="i">#</span> Logs 12</span>
          <span class="stat" style="color:var(--red)"><span class="i">‚óè</span> Open 0</span>
          <span class="stat" style="color:var(--green)"><span class="i">‚úî</span> Closed 3</span>
        </div>
      </div>

      <div class="card project-item"
           data-title="DXL-350 Docs dxl350 docs"
           data-hours="25" data-logs="8" data-open="2" data-closed="1"
           data-hours-by='{"Marta":7,"Ruta":13,"Elvijs":5}'>
        <div class="spaced">
          <strong>DXL-350 Docs</strong>
          <span class="stat hours head"><span class="i">üïí</span> 25h total</span>
        </div>
        <div class="muted" style="margin:6px 0 8px">Hours by engineer</div>
        <div class="mini-bars">
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Marta</span><div class="bar" style="flex:1"><div class="fill" style="width:28%"></div></div><span class="muted">7h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Ruta</span><div class="bar" style="flex:1"><div class="fill" style="width:52%"></div></div><span class="muted">13h</span></div>
          <div class="row" style="gap:8px"><span class="muted" style="width:90px">Elvijs</span><div class="bar" style="flex:1"><div class="fill" style="width:20%"></div></div><span class="muted">5h</span></div>
        </div>
        <div class="stats" style="margin-top:12px">
          <span class="stat"><span class="i">#</span> Logs 8</span>
          <span class="stat" style="color:var(--red)"><span class="i">‚óè</span> Open 2</span>
          <span class="stat" style="color:var(--green)"><span class="i">‚úî</span> Closed 1</span>
        </div>
      </div>

      <!-- Idle example -->
      <div class="card project-item"
           data-title="QA Sandbox qa-sandbox"
           data-hours="0" data-logs="0" data-open="0" data-closed="0"
           data-hours-by='{}'>
        <div class="spaced">
          <strong>QA Sandbox</strong>
          <span class="stat hours head"><span class="i">üïí</span> 0h total</span>
        </div>
        <p class="muted" style="margin-top:6px">No activity in selected period.</p>
      </div>
    </div>
  </div>
</div>

<!-- Issues modal -->
<div class="modal" id="issueListModal">
  <div class="panel" style="max-width:860px">
    <div class="spaced"><h3 id="issueModalTitle">Issues</h3><button class="btn" data-close>Close</button></div>
    <table style="width:100%; margin-top:8px">
      <thead><tr><th>ID</th><th>Title</th><th>Status</th><th>Project</th><th>Owner</th><th>When</th><th>How / Resolution</th></tr></thead>
      <tbody id="issueModalBody"></tbody>
    </table>
  </div>
</div>

<!-- Logs modal -->
<div class="modal" id="logListModal">
  <div class="panel" style="max-width:760px">
    <div class="spaced"><h3 id="logModalTitle">Time logs</h3><button class="btn" data-close>Close</button></div>
    <table style="width:100%; margin-top:8px">
      <thead><tr><th>Date</th><th>Project</th><th>Hours</th><th>Comment</th></tr></thead>
      <tbody id="logModalBody"></tbody>
    </table>
  </div>
</div>
